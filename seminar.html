<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="assets/favicon.png">
    <title>Seminar Details ‚Äì WTM Management Consulting</title>
    <meta name="description" content="Seminar Details WTM Management Consulting">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:wght@300;400;600;700&display=swap"
        rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="styles/index.css">
    <style>
        .val-toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: #333;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            font-family: 'Source Sans Pro', sans-serif;
            font-size: 16px;
            z-index: 10000;
            opacity: 0;
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.3s ease;
        }

        .val-toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .loading-spinner-small {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body>

    <!-- Scroll Progress Indicator -->
    <div class="scroll-progress" id="scrollProgress"></div>

    <!-- Header -->
    <header id="header" class="header-dark">
        <div class="container">
            <nav>
                <a href="index.html" class="logo">
                    <img src="assets/wtm_logo_gross.png" alt="WTM Management Consulting">
                </a>
                <div class="menu-toggle" id="mobile-menu">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
                <ul class="nav-links">
                    <li><a href="index.html#haltung" class="nav-link">Haltung</a></li>
                    <li><a href="index.html#angebote" class="nav-link">Angebote</a></li>
                    <li><a href="index.html#trainings" class="nav-link">Trainings</a></li>
                    <li><a href="index.html#team" class="nav-link">Team</a></li>
                    <li><a href="index.html#kontakt" class="nav-link">Kontakt</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content - will be injected dynamically -->
    <main id="main-content">
        <!-- Loading state -->
        <div class="seminar-loading">
            <div class="loading-spinner"></div>
        </div>
    </main>

    <!-- Chatbot Helper Panel -->
    <!-- Chatbot Helper Panel (Redesigned) -->
    <div class="chatbot-helper" id="chatbotHelper">
        <button class="chatbot-helper-btn" id="openChatbot">
            <div class="btn-icon-wrapper">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
            </div>
            <div class="btn-text-content">
                <span class="btn-title">Fragen?</span>
                <span class="btn-subtitle">Ich helfe gerne</span>
            </div>
        </button>
    </div>

    <!-- Footer (Same as Main Page) -->
    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand reveal stagger-1">
                    <a href="index.html" class="logo">
                        <img src="assets/logo.png" alt="WTM Management Consulting">
                    </a>
                    <p>Training ¬∑ Coaching ¬∑ Beratung<br>Seit √ºber 25 Jahren.</p>
                    <div class="footer-social">
                        <a href="https://www.facebook.com/wtm.mc" target="_blank" rel="noopener" aria-label="Facebook">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
                            </svg>
                        </a>
                        <a href="https://twitter.com/WTM_Consulting" target="_blank" rel="noopener"
                            aria-label="Twitter">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z" />
                            </svg>
                        </a>
                        <a href="https://www.linkedin.com/company/wtm-management-consulting" target="_blank"
                            rel="noopener" aria-label="LinkedIn">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" />
                            </svg>
                        </a>
                        <a href="https://www.youtube.com/channel/UC4rGdW9ApMpjFxbosjRshQg" target="_blank"
                            rel="noopener" aria-label="YouTube">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z" />
                            </svg>
                        </a>
                    </div>
                </div>

                <div class="footer-col reveal stagger-2">
                    <h4>Angebote</h4>
                    <ul class="footer-links">
                        <li><a href="index.html#trainings">Trainings & Seminare</a></li>
                        <li><a href="index.html#angebote">Coaching</a></li>
                        <li><a href="index.html#angebote">Teamentwicklung</a></li>
                        <li><a href="index.html#trainings">Ausbildungen</a></li>
                    </ul>
                </div>

                <div class="footer-col reveal stagger-3">
                    <h4>Kontakt</h4>
                    <ul class="footer-links footer-contact">
                        <li>Neuer Graben 61</li>
                        <li>44139 Dortmund</li>
                        <li><a href="tel:+4923113722666">0231 137 22 666</a></li>
                        <li><a href="mailto:info@wtm-consulting.de">info@wtm-consulting.de</a></li>
                    </ul>
                </div>

                <div class="footer-col reveal stagger-4">
                    <h4>Rechtliches</h4>
                    <ul class="footer-links">
                        <li><a href="impressum.html">Impressum</a></li>
                        <li><a href="datenschutz.html">Datenschutz</a></li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <div class="copyright">
                    <p>&copy; 2026 WTM Management Consulting GmbH. Alle Rechte vorbehalten.</p>
                </div>
                <div class="footer-version">
                    <span>v0.2.56</span>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="js/seminar-data.js"></script>
    <script src="js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const seminarId = params.get('id');
            const mainContent = document.getElementById('main-content');
            const chatbotHelper = document.getElementById('chatbotHelper');

            if (!seminarId || !window.seminarsData[seminarId]) {
                mainContent.innerHTML = `
                    <section class="seminar-not-found">
                        <div class="container">
                            <div class="not-found-card">
                                <div class="not-found-icon">üîç</div>
                                <h2>Seminar nicht gefunden</h2>
                                <p>Das gesuchte Seminar konnte nicht gefunden werden.</p>
                                <a href="index.html#trainings" class="btn btn-primary">Zur √úbersicht</a>
                            </div>
                        </div>
                    </section>
                `;
                chatbotHelper.style.display = 'none';
                return;
            }

            const seminar = window.seminarsData[seminarId];
            const categoryColors = {
                'leadership': 'var(--color-cat-leadership)',
                'change': 'var(--color-cat-change)',
                'health': 'var(--color-cat-health)',
                'communication': 'var(--color-cat-communication)',
                'management': 'var(--color-cat-management)'
            };
            const categoryLabels = {
                'leadership': 'F√ºhrung',
                'change': 'Change',
                'health': 'Gesundheit',
                'communication': 'Kommunikation',
                'management': 'Management'
            };
            const categoryColor = categoryColors[seminar.category] || 'var(--color-accent)';
            const categoryLabel = categoryLabels[seminar.category] || 'Seminar';

            // Update Page Title
            document.title = `${seminar.title} ‚Äì WTM Management Consulting`;

            // Set category color as CSS variable
            document.documentElement.style.setProperty('--current-category-color', categoryColor);

            // Generate goal cards HTML
            const goalCardsHTML = seminar.content.ziele.map((ziel, index) => `
                <div class="goal-card reveal stagger-${index + 1}">
                    <span class="goal-number">${String(index + 1).padStart(2, '0')}</span>
                    <p class="goal-text">${ziel}</p>
                </div>
            `).join('');

            // Generate timeline items for content
            // Generate timeline items for content ("Learning Journey")
            const contentItems = seminar.content.inhalte.split('. ').filter(item => item.trim());
            const timelineHTML = contentItems.map((item, index) => {
                const cleanItem = item.trim().replace(/\.$/, '');
                return `
                <div class="timeline-item" data-index="${index}" style="--item-index: ${index}">
                    <div class="timeline-marker">
                        <div class="timeline-label">Modul ${index + 1}</div>
                        <div class="timeline-dot">
                            <div class="timeline-dot-inner"></div>
                            <div class="timeline-dot-ring"></div>
                        </div>
                    </div>
                    <div class="timeline-content">
                        <div class="timeline-card">
                            <div class="timeline-header">
                                <h3>${cleanItem}</h3>
                                <div class="timeline-expand-icon">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </div>
                            </div>
                            <div class="timeline-details">
                                <div class="timeline-details-inner">
                                    <p>In diesem Teil des Seminars fokussieren wir uns auf <strong>${cleanItem}</strong>. Wir erarbeiten praxisnahe L√∂sungen und reflektieren die Anwendung im eigenen F√ºhrungsalltag.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `}).join('');

            // Render Content
            mainContent.innerHTML = `
                <!-- Hero Section -->
                <section class="seminar-hero" data-category="${seminar.category}">
                    <div class="seminar-hero-bg">
                        <div class="hero-shape hero-shape-1"></div>
                        <div class="hero-shape hero-shape-2"></div>
                        <div class="hero-shape hero-shape-3"></div>
                    </div>
                    <div class="container">
                        <div class="seminar-hero-content">
                            <div class="breadcrumb reveal">
                                <a href="index.html">Start</a>
                                <span class="breadcrumb-sep">‚Ä∫</span>
                                <a href="index.html#trainings">Trainings</a>
                                <span class="breadcrumb-sep">‚Ä∫</span>
                                <span class="breadcrumb-current">${seminar.title}</span>
                            </div>
                            
                            <span class="seminar-category-badge reveal stagger-1" style="--cat-color: ${categoryColor}">
                                ${categoryLabel}
                            </span>
                            
                            <h1 class="seminar-title reveal stagger-2">${seminar.title}</h1>
                            
                            <p class="seminar-subtitle reveal stagger-3">${seminar.shortDescription}</p>
                            
                            <div class="seminar-meta reveal stagger-4">
                                ${seminar.details.map(detail => `
                                    <span class="meta-badge">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                                        </svg>
                                        ${detail}
                                    </span>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Philosophy Section -->
                <section class="seminar-philosophy">
                    <div class="container">
                        <div class="philosophy-quote reveal">
                            <blockquote>
                                ${seminar.content.intro}
                            </blockquote>
                            <div class="quote-decoration" style="--cat-color: ${categoryColor}"></div>
                        </div>
                    </div>
                </section>

                <!-- Goals Section -->
                <section class="seminar-goals">
                    <div class="container">
                        <div class="section-header">
                            <span class="section-label reveal">Lernziele</span>
                            <h2 class="reveal stagger-1">Was Sie mitnehmen</h2>
                            <div class="accent-line reveal stagger-2" style="background: ${categoryColor}"></div>
                        </div>
                        <div class="goals-grid">
                            ${goalCardsHTML}
                        </div>
                    </div>
                </section>

                <!-- Content Timeline Section -->
                <section class="seminar-content-section bg-cream">
                    <div class="container">
                        <div class="section-header">
                            <span class="section-label reveal">Seminarinhalte</span>
                            <h2 class="reveal stagger-1">Ihre Lernreise</h2>
                            <div class="accent-line reveal stagger-2" style="background: ${categoryColor}"></div>
                        </div>
                        <div class="timeline-container">
                            <div class="timeline-line"></div>
                            ${timelineHTML}
                        </div>
                    </div>
                </section>

                <!-- Benefits Section -->
                <section class="seminar-benefits">
                    <div class="container">
                        <div class="benefits-grid">
                            <div class="benefits-content reveal">
                                <span class="section-label">Ihr Nutzen</span>
                                <h2>Was Sie davon haben</h2>
                                <div class="accent-line left" style="background: ${categoryColor}"></div>
                                <div class="benefit-highlight" style="--cat-color: ${categoryColor}">
                                    <p>${seminar.content.nutzen}</p>
                                </div>
                            </div>
                            <div class="benefits-visual reveal reveal-right">
                                <div class="benefit-icon-box" style="--cat-color: ${categoryColor}">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <path d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Target Group & CTA Section -->
                <section class="seminar-cta-section bg-dark">
                    <div class="container">
                        <div class="cta-grid">
                            <div class="target-group reveal">
                                <div class="target-group-card">
                                    <span class="section-label light">Zielgruppe</span>
                                    <h3>F√ºr wen ist dieses Seminar?</h3>
                                    <p>${seminar.content.zielgruppe}</p>
                                </div>
                            </div>
                            <div class="cta-content reveal reveal-right">
                                <h2>Jetzt anfragen</h2>
                                <p>Interessiert? Wir beraten Sie gerne zu diesem Seminar und passen die Inhalte an Ihre Bed√ºrfnisse an.</p>
                                <a href="index.html#kontakt" class="btn btn-white btn-lg">
                                    Kontakt aufnehmen
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                                        <line x1="5" y1="12" x2="19" y2="12"></line>
                                        <polyline points="12 5 19 12 12 19"></polyline>
                                    </svg>
                                </a>
                            </div>
                        </div>
                    </div>
                </section>
            `;

            // Setup scroll progress
            setupScrollProgress();

            // Setup chatbot helper visibility
            setupChatbotHelper();

            // Setup Timeline Interactions (Hover/Click)
            setupTimelineInteractions();

            // Initialize reveal animations
            initRevealAnimations();
        });

        // Scroll Progress Indicator
        function setupScrollProgress() {
            const scrollProgress = document.getElementById('scrollProgress');
            window.addEventListener('scroll', () => {
                const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
                const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                const scrolled = (winScroll / height) * 100;
                scrollProgress.style.width = scrolled + '%';
            });
        }

        // Chatbot Helper Panel
        function setupChatbotHelper() {
            const chatbotHelper = document.getElementById('chatbotHelper');
            const heroSection = document.querySelector('.seminar-hero');

            if (!heroSection) return;

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (!entry.isIntersecting) {
                        chatbotHelper.classList.add('visible');
                    } else {
                        chatbotHelper.classList.remove('visible');
                    }
                });
            }, { threshold: 0.3 });

            observer.observe(heroSection);

            // Click handler for chatbot button
            const chatbotBtn = document.getElementById('openChatbot');
            if (chatbotBtn) {
                chatbotBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    openVallitChat();
                });
            }
        }

        // Open Vallit Chat Widget with smooth animation and feedback
        function openVallitChat() {
            console.log('Attempting to open Vallit Chat...');

            const btn = document.getElementById('openChatbot');
            const originalContent = btn.innerHTML;

            // Set loading state
            btn.innerHTML = '<div class="btn-icon-wrapper"><div class="loading-spinner-small"></div></div><div class="btn-text-content"><span class="btn-title">Lade...</span></div>';
            btn.style.cursor = 'wait';

            // Helper to find the toggle button
            const findToggle = () =>
                document.querySelector('.syntra-toggle-btn') ||
                document.querySelector('[data-vallit-toggle]') ||
                document.querySelector('.vallit-widget-toggle') ||
                document.querySelector('#vallit-launcher');

            const openChat = (toggleBtn) => {
                console.log('Found toggle button, clicking:', toggleBtn);
                toggleBtn.click();

                // Dispatch explicit click just in case
                const clickEvent = new MouseEvent('click', {
                    view: window,
                    bubbles: true,
                    cancelable: true
                });
                toggleBtn.dispatchEvent(clickEvent);

                document.getElementById('chatbotHelper').classList.add('opened');

                // Reset button state
                btn.innerHTML = originalContent;
                btn.style.cursor = '';

                watchForChatClose();
            };

            const toggleBtn = findToggle();

            if (toggleBtn) {
                openChat(toggleBtn);
            } else {
                console.log('Toggle button not found immediately, polling...');
                // Widget might be loading, try polling for a few seconds
                let attempts = 0;
                const maxAttempts = 10; // 2.5 seconds total (250ms interval) - reduced from 5s

                const pollInterval = setInterval(() => {
                    attempts++;
                    const foundBtn = findToggle();

                    if (foundBtn) {
                        clearInterval(pollInterval);
                        openChat(foundBtn);
                    } else if (attempts >= maxAttempts) {
                        clearInterval(pollInterval);
                        console.error('Chat widget not found after timeout.');

                        // Reset button state
                        btn.innerHTML = originalContent;
                        btn.style.cursor = '';

                        // Show Toast
                        showToast('Der Chat Assistent ist gerade nicht verf√ºgbar. Wir leiten Sie zum Kontaktformular weiter.');

                        // Fallback to contact section after short delay
                        setTimeout(() => {
                            window.location.href = 'index.html#kontakt';
                        }, 2500);
                    }
                }, 250);
            }
        }

        // Simple Toast Notification
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'val-toast';
            toast.textContent = message;
            document.body.appendChild(toast);

            // Force reflow
            toast.offsetHeight;

            toast.classList.add('show');

            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
        }

        // Watch for Vallit chat widget closing to restore helper button
        function watchForChatClose() {
            const helper = document.getElementById('chatbotHelper');
            if (!helper) return;

            const findChatContainer = () =>
                document.querySelector('.syntra-chat-container') ||
                document.querySelector('.vallit-widget-container') ||
                document.querySelector('[data-vallit-container]') ||
                document.querySelector('.syntra-widget');

            let chatContainer = findChatContainer();

            if (!chatContainer) {
                const containerObserver = new MutationObserver((mutations, obs) => {
                    chatContainer = findChatContainer();
                    if (chatContainer) {
                        obs.disconnect();
                        setupCloseWatcher(chatContainer, helper);
                    }
                });
                containerObserver.observe(document.body, { childList: true, subtree: true });

                setTimeout(() => {
                    containerObserver.disconnect();
                    if (helper.classList.contains('opened')) {
                        helper.classList.remove('opened');
                    }
                }, 30000);
            } else {
                setupCloseWatcher(chatContainer, helper);
            }
        }

        function setupCloseWatcher(container, helper) {
            const observer = new MutationObserver((mutations) => {
                for (const mutation of mutations) {
                    if (mutation.removedNodes.length > 0) {
                        for (const node of mutation.removedNodes) {
                            if (node === container || node.contains(container)) {
                                helper.classList.remove('opened');
                                observer.disconnect();
                                return;
                            }
                        }
                    }

                    if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                        const target = mutation.target;
                        if (target.classList.contains('closed') ||
                            target.classList.contains('hidden') ||
                            target.classList.contains('syntra-hidden') ||
                            !target.classList.contains('syntra-open') && !target.classList.contains('open')) {
                            if (helper.classList.contains('opened')) {
                                helper.classList.remove('opened');
                                observer.disconnect();
                                return;
                            }
                        }
                    }
                }
            });

            observer.observe(container.parentElement || document.body, {
                childList: true,
                subtree: true,
                attributes: true,
                attributeFilter: ['class', 'style']
            });

            const closeBtn = container.querySelector('.syntra-close-btn, .close-btn, [data-close], .vallit-close');
            if (closeBtn) {
                closeBtn.addEventListener('click', () => {
                    setTimeout(() => {
                        helper.classList.remove('opened');
                        observer.disconnect();
                    }, 300);
                }, { once: true });
            }

            const visibilityPoll = setInterval(() => {
                if (!document.contains(container) ||
                    container.style.display === 'none' ||
                    container.style.visibility === 'hidden' ||
                    container.offsetParent === null) {
                    helper.classList.remove('opened');
                    observer.disconnect();
                    clearInterval(visibilityPoll);
                }
            }, 500);

            setTimeout(() => {
                observer.disconnect();
                clearInterval(visibilityPoll);
            }, 120000);
        }

        // =============================================
        // PREMIUM TIMELINE INTERACTIONS
        // =============================================
        function setupTimelineInteractions() {
            const container = document.querySelector('.timeline-container');
            const items = document.querySelectorAll('.timeline-item');

            if (!container || items.length === 0) return;

            // Staggered reveal animation on load
            items.forEach((item, index) => {
                item.style.opacity = '0';
                item.style.transform = 'translateY(30px)';

                setTimeout(() => {
                    item.style.transition = 'opacity 0.6s cubic-bezier(0.16, 1, 0.3, 1), transform 0.6s cubic-bezier(0.16, 1, 0.3, 1)';
                    item.style.opacity = '';
                    item.style.transform = '';
                }, 100 + (index * 120));
            });

            // Activate first item after reveal
            setTimeout(() => {
                if (items[0]) activateItem(items[0]);
            }, 800);

            // Click handlers
            items.forEach(item => {
                const card = item.querySelector('.timeline-card');
                if (card) {
                    card.addEventListener('click', (e) => {
                        e.stopPropagation();
                        toggleItem(item);
                    });
                }
            });
        }

        // Smooth height animation helper
        function animateHeight(element, from, to, duration = 400) {
            if (from === to) return Promise.resolve();

            const start = performance.now();

            return new Promise(resolve => {
                function tick(now) {
                    const elapsed = now - start;
                    const progress = Math.min(elapsed / duration, 1);

                    // Smooth easing (easeOutQuint)
                    const eased = 1 - Math.pow(1 - progress, 5);
                    const currentHeight = from + (to - from) * eased;

                    element.style.height = `${currentHeight}px`;

                    if (progress < 1) {
                        requestAnimationFrame(tick);
                    } else {
                        element.style.height = to === 0 ? '0' : 'auto';
                        resolve();
                    }
                }
                requestAnimationFrame(tick);
            });
        }

        // Activate a timeline item with smooth animation
        function activateItem(item) {
            if (item.classList.contains('active')) return;

            const details = item.querySelector('.timeline-details');
            const inner = item.querySelector('.timeline-details-inner');

            if (!details || !inner) {
                item.classList.add('active');
                return;
            }

            // Get target height
            details.style.height = 'auto';
            const targetHeight = details.offsetHeight;
            details.style.height = '0';

            // Add active class for visual changes
            item.classList.add('active');

            // Animate height
            animateHeight(details, 0, targetHeight, 450);
        }

        // Deactivate a timeline item
        function deactivateItem(item) {
            if (!item.classList.contains('active')) return;

            const details = item.querySelector('.timeline-details');

            if (!details) {
                item.classList.remove('active');
                return;
            }

            const currentHeight = details.offsetHeight;

            // Animate height first, then remove class
            animateHeight(details, currentHeight, 0, 350).then(() => {
                item.classList.remove('active');
            });
        }

        // Toggle item state
        function toggleItem(targetItem) {
            const items = document.querySelectorAll('.timeline-item');
            const isActive = targetItem.classList.contains('active');

            // Deactivate all other items
            items.forEach(item => {
                if (item !== targetItem && item.classList.contains('active')) {
                    deactivateItem(item);
                }
            });

            // Toggle target
            if (isActive) {
                deactivateItem(targetItem);
            } else {
                activateItem(targetItem);
            }
        }


        // Initialize reveal animations  
        function initRevealAnimations() {
            const reveals = document.querySelectorAll('.reveal, .reveal-left, .reveal-right');

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            });

            reveals.forEach(el => observer.observe(el));
        }
    </script>

    <!-- Vallit AI Chat Widget -->
    <script src="https://www.vallit.net/widget/embed.js" data-api-url="https://www.vallit.net"
        data-company-id="e46176c5-0f35-43b8-8e8c-c72f534519e1" data-theme="minimal" data-language="de" data-position=""
        data-color="#6366f1" data-title="Kian">
        </script>
</body>

</html>